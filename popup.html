<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Local Resume & Cover Letter Tailor</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>ÔøΩ Local Resume & Cover Letter Tailor</h1>
        <p class="subtitle">
          On-device with Chrome's Built-in AI (Gemini Nano)
        </p>
      </header>

      <!-- API Status (overall) -->
      <div id="apiStatus" class="status-box">
        <span class="status-indicator">‚óè</span>
        <span id="statusText">Checking AI availability...</span>
      </div>

      <!-- Per-API Status Matrix -->
      <div id="apiMatrix" class="options-section" style="margin-top: -8px">
        <div class="option-group">
          <label>API status:</label>
          <div style="display: flex; gap: 10px; flex-wrap: wrap">
            <span id="statusSummarizer">Summarizer: ‚Ä¶</span>
            <span id="statusWriter">Writer: ‚Ä¶</span>
            <span id="statusRewriter">Rewriter: ‚Ä¶</span>
            <span id="statusProofreader">Proofreader: ‚Ä¶</span>
          </div>
        </div>
      </div>

      <!-- Model Download Status -->
      <div id="modelStatus" class="model-status-box" style="display: none">
        <div class="model-status-header">
          <span id="modelStatusIcon">üì¶</span>
          <span id="modelStatusText">Model Status</span>
          <button
            id="refreshModelStatus"
            class="btn-icon"
            title="Refresh model status"
          >
            üîÑ
          </button>
        </div>
        <div
          id="modelProgressBar"
          class="model-progress-bar"
          style="display: none"
        >
          <div id="modelProgressFill" class="model-progress-fill"></div>
        </div>
        <p id="modelStatusDetail" class="model-status-detail"></p>
      </div>

      <!-- Inputs -->
      <div class="input-section">
        <label for="jdInput">Job Description</label>
        <textarea
          id="jdInput"
          placeholder="Paste the job description here‚Ä¶"
          rows="6"
        ></textarea>
        <div class="button-group" style="margin-top: 6px">
          <button id="captureJD" class="btn btn-secondary">
            üìÑ Capture from current page
          </button>
        </div>
      </div>

      <div class="input-section">
        <label for="resumeInput">Your Resume Bullets (optional)</label>
        <textarea
          id="resumeInput"
          placeholder="Paste 3‚Äì10 bullets about your experience‚Ä¶"
          rows="6"
        ></textarea>
      </div>

      <!-- Configuration Options -->
      <div class="options-section">
        <div class="option-group">
          <label for="toneSelect">Tone</label>
          <select id="toneSelect">
            <option value="professional" selected>Professional</option>
            <option value="confident">Confident</option>
            <option value="friendly">Friendly</option>
            <option value="neutral">Neutral</option>
          </select>
        </div>

        <div class="option-group">
          <label for="bulletsLength">Bullets Length</label>
          <select id="bulletsLength">
            <option value="short">Short</option>
            <option value="medium" selected>Medium</option>
            <option value="long">Long</option>
          </select>
        </div>

        <div class="option-group">
          <label for="letterLength">Cover Letter Length</label>
          <select id="letterLength">
            <option value="short">Short</option>
            <option value="medium" selected>Medium</option>
          </select>
        </div>

        <div class="option-group">
          <label for="preferMetrics">Preferences</label>
          <div>
            <input type="checkbox" id="preferMetrics" />
            <label for="preferMetrics"
              >Prefer metrics (#, %, $) in bullets</label
            >
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="button-group">
        <button id="tailorNow" class="btn btn-primary">üéØ Tailor Now</button>
        <button id="regenBullets" class="btn btn-secondary" disabled>
          üîÅ Regenerate Bullets
        </button>
        <button id="regenLetter" class="btn btn-secondary" disabled>
          ÔøΩ Regenerate Letter
        </button>
      </div>

      <!-- Progress Indicator -->
      <div
        id="progressContainer"
        class="progress-container"
        style="display: none"
      >
        <div class="progress-bar">
          <div id="progressBar" class="progress-fill"></div>
        </div>
        <p id="progressText" class="progress-text">Processing...</p>
      </div>

      <!-- Results: Tailored Bullets -->
      <div
        id="bulletsContainer"
        class="summary-container"
        style="display: none"
      >
        <h3>Tailored Resume Bullets (5)</h3>
        <div id="bulletsOutput" class="summary-output"></div>
        <button id="copyBullets" class="btn btn-small">
          üìã Copy All Bullets
        </button>
      </div>

      <!-- Results: Cover Letter -->
      <div id="letterContainer" class="summary-container" style="display: none">
        <h3>Draft Cover Letter</h3>
        <div id="letterOutput" class="summary-output"></div>
        <button id="copyLetter" class="btn btn-small">üìã Copy Letter</button>
      </div>

      <!-- Versions -->
      <div id="versionsContainer" class="options-section">
        <div class="option-group">
          <label>Versions</label>
          <div style="display: flex; gap: 8px">
            <button id="saveVersion" class="btn btn-small">
              üíæ Save Version
            </button>
            <button id="refreshVersions" class="btn btn-small">
              üîÑ Refresh
            </button>
          </div>
        </div>
        <div
          id="versionsList"
          class="summary-output"
          style="font-size: 12px; color: #5f6368"
        ></div>
      </div>

      <!-- Error Display -->
      <div id="errorContainer" class="error-container" style="display: none">
        <h3>‚ö†Ô∏è Error:</h3>
        <p id="errorText"></p>
      </div>

      <!-- Instructions -->
      <div class="info-section">
        <details>
          <summary>‚ÑπÔ∏è How to use</summary>
          <ul>
            <li>Paste a job description (or capture from the current page)</li>
            <li>Optionally paste your existing resume bullets</li>
            <li>Pick tone and lengths, then click "Tailor Now"</li>
            <li>Copy bullets and letter; save versions for later</li>
            <li>Check model status in the "Model Status" box above</li>
            <li>
              <strong>If model shows "downloadable":</strong> Click "Tailor Now"
              to start download (requires ~22GB storage)
            </li>
          </ul>
          <p class="note">
            <strong>Note:</strong> Requires Chrome 138+ with Built-in AI
            enabled. Writer/Rewriter/Proofreader may require origin trials or
            flags during development.
          </p>
        </details>
        <details>
          <summary>‚ö†Ô∏è Origin Trial Notice</summary>
          <p style="font-size: 12px; color: #5f6368">
            <strong>Writer, Rewriter, and Proofreader APIs</strong> are in
            origin trial. For local testing, enable flags:<br />
            <code>chrome://flags/#optimization-guide-on-device-model</code
            ><br />
            <code>chrome://flags/#text-safety-classifier</code><br />
            For production, register at
            <a href="https://developer.chrome.com/origintrials" target="_blank"
              >Chrome Origin Trials</a
            >
            and add tokens to manifest.json.
          </p>
        </details>
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
